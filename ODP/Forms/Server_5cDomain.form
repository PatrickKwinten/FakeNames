<?xml version='1.0' encoding='utf-8'?>
<form name='Server\Domain' alias='Domain|Foreign Domain|Gateway Domain|Domain'
 xmlns='http://www.lotus.com/dxl' version='9.0' maintenanceversion='1.5' replicaid='C1257E4300352F3F'
 htmlallfields='true' publicaccess='false' designerversion='8.5' language='en'>
<noteinfo noteid='48a' unid='852560B30065DAE4852558A40018F609' sequence='5500'>
<created><datetime>19881227T233238,49-05</datetime></created>
<modified><datetime dst='true'>20150512T114059,08+02</datetime></modified>
<revised><datetime dst='true'>20130909T095406,38-04</datetime></revised>
<lastaccessed><datetime dst='true'>20150512T114059,08+02</datetime></lastaccessed>
<addedtofile><datetime dst='true'>20150512T114059,08+02</datetime></addedtofile></noteinfo>
<updatedby><name>CN=Lotus Notes Template Development/O=Lotus Notes</name></updatedby>
<revisions><datetime>20100304T144031,11-05</datetime></revisions>
<wassignedby><name>CN=Lotus Notes Template Development/O=Lotus Notes</name></wassignedby><code
 event='windowtitle'><formula>@If(@IsNewDoc;"New Domain";@Replace(DomainType;"ForeignDomain":"NonAdjacentDomain":"AdjacentDomain":"DomainRule":"SMTPDomain":"ccMailDomain":"GlobalDomain";"Foreign Domain":
"Non-adjacent Domain":
"Adjacent Domain":
"Foreign X.400 Domain":
"Foreign SMTP Domain":
"Foreign cc:Mail Domain":
"Global Domain"))</formula></code><code event='webqueryopen'><formula>@If(@IsNewDoc;@Command([ToolsRunMacro]; "(wSetAdminOwnFields)");"")</formula></code><code
 event='htmlbody'><formula>"topmargin=0 leftmargin=0 marginheight=0 marginwidth=0"</formula></code><code
 event='helprequest'><formula>domtype:=@GetField("DomainType");

HelpDoc := @If(
	domtype = "ForeignDomain";		"pubnames_f_Domain_foreign";
	domtype = "NonAdjacentDomain";	"pubnames_f_Domain_nonadj";
	domtype = "AdjacentDomain";		"pubnames_f_Domain_adj";
	domtype = "DomainRule";			"pubnames_f_Domain_for_x400";
	domtype = "SMTPDomain";			"pubnames_f_Domain_for_smtp";
	domtype = "ccMailDomain";		"pubnames_f_Domain_for_ccmail";
	domtype = "GlobalDomain";		"pubnames_f_Domain_glob";
	"pubnames_f_Domain");

@Command([OpenHelpDocument]; [AdminHelp]; "(Help)"; HelpDoc)</formula></code><code
 event='htmlhead'><formula>_tDb	:= @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_is6	:= @TextToNumber(@Version) &gt; 171;

"&lt;meta http-equiv='expires' content='0'&gt;
&lt;link rel=stylesheet type='text/css' href='/" + _tDb + "/cssForm?ReadForm'&gt;
&lt;script&gt;
	var sDefaultView	= 'Domains';
	var sWebDbName		= '/" + _tDb + "/';
&lt;/script&gt;" +
@If(_is6;
	"&lt;script src='/" + _tDb + "/WebJSTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;
	 &lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";

	"&lt;script src='/" + _tDb + "/WebJSNavigationTools5?OpenPage'&gt;&lt;/script&gt;"
)</formula></code>
<actionbar linestyle='triple' useappletinbrowser='true' bgcolor='#b1b1d2'
 bordercolor='black'>
<actionbuttonstyle bgcolor='none'/><border style='solid' width='0px 0px 3px'/>
<action title='Edit Domain' showinmenu='false' hide='edit previewedit web'><imageref
 name='btnEdit.gif'/><code event='click'><formula>@Command([EditDocument])</formula></code></action>
<action title='Edit Domain' showinmenu='false' hide='edit previewedit notes'><imageref
 name='btnEdit.gif'/><code event='onClick' for='web'><javascript>ntEditDoc('[NetModifier]')</javascript></code></action>
<action title='Save &amp; Close' showinmenu='false' hide='preview read previewedit web'><imageref
 name='btnSave.gif'/><code event='click'><formula>@PostedCommand([FileSave]);
@PostedCommand([FileCloseWindow])</formula></code></action>
<action title='Save &amp; Close' showinmenu='false' hide='preview read previewedit notes'><imageref
 name='btnSave.gif'/><code event='onClick' for='web'><javascript>ntSaveAndClose()
</javascript></code></action>
<action title='Refresh' showinmenu='false' hide='preview read notes'><imageref
 name='btnRefresh.gif'/><code event='click'><formula>@Command([ViewRefreshFields])</formula></code></action>
<action title='Cancel' showinmenu='false' hide='preview previewedit web'><imageref
 name='btnCancel.gif'/><code event='click'><formula>REM {Notes only};
FIELD SaveOptions := 0;
@Command([FileCloseWindow])</formula></code></action>
<action title='Cancel' showinmenu='false' hide='notes'><imageref name='btnCancel.gif'/><code
 event='onClick' for='web'><javascript>ntCancel()</javascript></code></action>
<action title='Categorize' showinbar='false' systemcommand='categorize'/>
<action title='Edit Document' showinbar='false' systemcommand='edit'/>
<action title='Send Document' showinbar='false' systemcommand='send'/>
<action title='Forward' showinbar='false' systemcommand='forward'/>
<action title='Move To Folder...' showinbar='false' systemcommand='movetofolder'/>
<action title='Remove From Folder' showinbar='false' systemcommand='removefromfolder'/></actionbar>
<body><richtext>
<pardef id='1' align='none' leftmargin='1in' hide='notes web' tabs='L0.5000in L1in L1.5000in L2in L2.5000in L3in L3.5000in L4in'/>
<par def='1'><run html='true'><font size='9pt'/></run><run html='true'><font
 size='9pt'/><sharedfieldref name='$HTMLAttributes'/></run><run html='true'><font
 size='9pt'/></run></par>
<table extrahtmlattrs='cellpadding=10' leftmargin='0.7500in' widthtype='fixedleft'
 refwidth='10.9896in'><tablecolumn width='10.9896in'/>
<tablerow>
<tablecell borderwidth='0px'>
<cellbackground><imageref name='intl'/></cellbackground>
<pardef id='3' leftmargin='0.0104in' hide='web' keepwithnext='true' keeptogether='true'/>
<par def='3'><run><font size='9pt'/> </run></par>
<pardef id='4' leftmargin='0.0104in' keepwithnext='true' keeptogether='true'/>
<par def='4'><run><font size='14pt' style='bold' color='#424282'/>  Domain  </run><run
><font size='12pt' color='#424282' style='bold'/><field type='names' kind='computedfordisplay'
 name='DisplayName' htmlid='DisplayName'><code event='defaultvalue'><formula
>DomainName</formula></code></field></run></par>
<pardef id='5' leftmargin='0.0104in' hide='web' keepwithnext='true' keeptogether='true'/>
<par def='5'><run><font size='9pt'/>Â  </run></par></tablecell></tablerow></table>
<pardef id='6' leftmargin='0.7500in' hide='notes web' tabs='L4.3125in L4.3125in L4.3750in'/>
<par def='6'><run><font size='9pt'/></run></par>
<table widthtype='fitwindow' rowdisplay='tabscompute' htmlid='SrvrDom' htmlclass='tbltestclass'
 extrahtmlattrs='cellpadding=7' leftmargin='0.7500in' refwidth='8.3215in'><tablerowstyle
><font size='9pt' color='black'/></tablerowstyle><tablecolumn width='100%'/>
<tablerow tablabel='Basics'>
<tablecell borderwidth='0px' bgcolor='white'>
<pardef id='8' leftmargin='0.1000in' keepwithnext='true' keeptogether='true'/>
<par def='8'><run><font size='9pt'/></run></par>
<table cellbordercolor='silver' htmlclass='TableSpacing' leftmargin='0.1000in'
 rightmargin='50%' widthtype='fixedleft' rowspacing='0.0201in' refwidth='5.5000in'><tablecolumn
 width='1.5000in'/><tablecolumn width='4in'/>
<tablerow>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='10' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'/>
<par def='10'><run><font size='9pt' style='bold' color='white'/>Basics</run></par></tablecell>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='11' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'/>
<par def='11'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='12' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'/>
<par def='12'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Choose the type of domain record you are creating.</popuptext><run><font
 size='9pt'/>Domain type:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='13' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'/>
<par def='13'><run><font size='9pt'/></run><run><font size='9pt'/><field lookupeachchar='false'
 lookupaddressonrefresh='false' type='keyword' kind='editable' name='DomainType'
 description='Choose the type of domain record you are creating.'><keywords
 recalconchange='true' columns='1' ui='dialoglist'><textlist><text>Foreign Domain|ForeignDomain</text><text
>Non-adjacent Domain|NonAdjacentDomain</text><text>Adjacent Domain|AdjacentDomain</text><text
>Foreign X.400 Domain|DomainRule</text><text>Foreign SMTP Domain|SMTPDomain</text><text
>Foreign cc:Mail Domain|ccMailDomain</text><text>Global Domain|GlobalDomain</text></textlist></keywords><code
 event='defaultvalue'><formula>@If(@IsNewDoc;"ForeignDomain";Form="Gateway Domain";"ForeignDomain";Form="Domain";"NonAdjacentDomain";"")</formula></code><code
 event='inputtranslation'><formula>FIELD CalendarSystem:=@If(DomainType="AdjacentDomain";@Unavailable;CalendarSystem);
DomainType</formula></code><code event='onchange'><lotusscript>Sub Onchange(Source As Field)
	Dim ws As New NotesUIWorkspace
	Dim uidoc As NotesUIDocument
	Dim doc As NotesDocument
	
	Set uidoc = ws.CurrentDocument
	Set doc = uidoc.Document
	
	If (doc.getitemvalue("DomainType")(0) = "GlobalDomain") Then
		Call doc.replaceItemvalue("SMTPNotesDomainIncluded","0")
	End If
End Sub</lotusscript></code></field></run><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<pardef id='14' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType != "NonAdjacentDomain"</formula></code></pardef>
<par def='14'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Enter the non-adjacent domain name.</popuptext><run><font size='9pt'/>Mail sent to domain:</run></popup><run
><font size='9pt'/></run></par>
<pardef id='15' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType != "ForeignDomain"</formula></code></pardef>
<par def='15'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Enter the foreign domain name.</popuptext><run><font size='9pt'/>Foreign domain name:</run></popup><run
><font size='9pt'/></run></par>
<pardef id='16' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="AdjacentDomain"</formula></code></pardef>
<par def='16'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Enter the adjacent domain name.</popuptext><run><font size='9pt'/>Adjacent domain name:</run></popup><run
><font size='9pt'/></run></par>
<pardef id='17' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='17'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Enter the global domain name.</popuptext><run><font size='9pt'/>Global domain name:</run></popup><run
><font size='9pt'/></run></par>
<pardef id='18' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="ccMailDomain"</formula></code></pardef>
<par def='18'><run><font size='9pt'/>cc:Mail domain name:</run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='19' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType="DomainRule":"SMTPDomain"</formula></code></pardef>
<par def='19'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 kind='editable' name='OtherDomainName'><code event='htmlattributes'><formula
>htmlInputL</formula></code><code event='defaultvalue'><formula>DEFAULT OtherDomainName:=DomainName;
OtherDomainName</formula></code><code event='inputvalidation'><formula>sMsg := @If(
     DomainType="ForeignDomain" &amp; OtherDomainName="";
		"You must supply a Foreign domain name before saving this document.";
     DomainType="NonAdjacentDomain" &amp; OtherDomainName="";
		"You must supply a domain name which mail will be sent to before saving this document.";
     DomainType="AdjacentDomain" &amp; OtherDomainName="";
		"You must supply an Adjacent domain name before saving this document.";
     DomainType="GlobalDomain"&amp; OtherDomainName="";
		"You must supply a Global Domain name before saving this document.";
	DomainType="ccMailDomain" &amp; OtherDomainName="";
		"You must supply a cc:Mail domain name before saving this document.";
	"");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='9' containertype='65418'
 aftercontainercount='1' afterbegincount='4'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<pardef id='20' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="NonAdjacentDomain"</formula></code></pardef>
<par def='20'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Enter the name of the domain to route mail through if sent to the above domain.</popuptext><run
><font size='9pt'/>Route through domain:</run></popup><run><font size='9pt'/></run></par>
<pardef id='21' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='21'><run><font size='9pt'/>Global domain role:</run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='22' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="NonAdjacentDomain"</formula></code></pardef>
<par def='22'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 kind='editable' name='NonAdjacentNextDomain' description='Name of next domain in route to destination domain.'><code
 event='htmlattributes'><formula>htmlInputL</formula></code><code event='defaultvalue'><formula
>NextDomain</formula></code></field></run><compositedata type='98' prevtype='65418'
 nexttype='222' afterparcount='9' containertype='65418' aftercontainercount='1'
 afterbegincount='4'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par>
<pardef id='23' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='23'><run><font size='9pt'/></run><run><font size='9pt'/><field type='keyword'
 allowmultivalues='true' kind='editable' name='GlobalDomainTasks' listinputseparators='comma'
 listdisplayseparator='comma'><keywords ui='dialoglist'><formula>"" : "R5/R6/R7/R8 Internet Domains or R4.x SMTP MTA|SMTP" : "X.400 MTA|X400"</formula></keywords><code
 event='inputvalidation'><formula>L_ERR_MSG := "You must choose at least one Global Domain role before saving this document.";

sMsg := @If(DomainType="GlobalDomain" &amp; GlobalDomainTasks=""; L_ERR_MSG; "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><run
><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<pardef id='24' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType="GlobalDomain":"DomainRule":"SMTPDomain"</formula></code></pardef>
<par def='24'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Enter a description for this domain.</popuptext><run><font size='9pt'/>Domain description:</run></popup><run
><font size='9pt'/></run></par>
<par def='21'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Use the specified Global Domain as the default Global Domain for IMAP, LDAP, NNTP and POP3.  The Global Domain provides the Internet Domain for these protocols.  You only need to set this field in the event that you have more than one Global Domain document.</popuptext><run
><font size='9pt'/>Use as default Global Domain (for use with all Internet protocols except HTTP):</run></popup><run
><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='25' leftmargin='0.0597in' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>DomainType="GlobalDomain":"DomainRule":"SMTPDomain"</formula></code></pardef>
<par def='25'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 kind='editable' name='Description' description='Enter a description for this domain.'><code
 event='htmlattributes'><formula>htmlInputXL</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='9' containertype='65418'
 aftercontainercount='1' afterbegincount='4'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par>
<pardef id='26' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='26'><run><font size='9pt'/></run><run><font size='9pt'/><field borderstyle='none'
 lookupeachchar='false' lookupaddressonrefresh='false' type='keyword' allowmultivalues='true'
 kind='editable' name='DefaultGlobalDomain' listinputseparators='comma' listdisplayseparator='comma'><keywords
 columns='1' ui='checkbox'><textlist><text>Yes|1</text></textlist></keywords></field></run><run
><font size='9pt' style='bold'/></run></par></tablecell></tablerow></table>
<pardef id='27' leftmargin='1%' hide='notes web' keepwithnext='true' keeptogether='true'/>
<par def='27'><run><font size='9pt'/></run></par>
<pardef id='28' leftmargin='1%' keepwithnext='true' keeptogether='true'/>
<par def='28'><run><font size='9pt'/></run></par>
<par def='27'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow tablabel='Restrictions'>
<tablecell borderwidth='0px' bgcolor='white'>
<pardef id='29' leftmargin='0.1000in' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>DomainType="DomainRule"</formula></code></pardef>
<par def='29'><run><font size='9pt'/></run></par>
<table cellbordercolor='silver' htmlclass='TableSpacing' leftmargin='0.1000in'
 rightmargin='50%' widthtype='fixedleft' rowspacing='0.0201in' refwidth='5.5000in'><tablecolumn
 width='1.5000in'/><tablecolumn width='4in'/>
<tablerow>
<tablecell columnspan='2' borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='31' leftmargin='0.0597in' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>DomainType = "GlobalDomain":"DomainRule":"SMTPDomain"</formula></code></pardef>
<par def='31'><run><font size='9pt' style='bold' color='white'/>Restrictions</run></par>
<pardef id='32' leftmargin='0.0597in' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>DomainType != "SMTPDomain"</formula></code></pardef>
<par def='32'><run><font size='9pt' style='bold' color='white'/>R4.x SMTP MTA Restrictions</run></par>
<pardef id='33' leftmargin='0.0597in' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>DomainType != "GlobalDomain"</formula></code></pardef>
<par def='33'><run><font size='9pt' style='bold' color='white'/>R5/R6/R7 Domino Domain Aliases/R4.x SMTP MTA Members</run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='34' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>DomainType = "GlobalDomain":"DomainRule"</formula></code></pardef>
<par def='34'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Domains that will be allowed to send mail to this domain.</popuptext><run
><font size='9pt'/>Allow mail only from domains:</run></popup><run><font size='9pt'/></run></par>
<pardef id='35' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='35'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>The list of Domino Domains which belong to this Global Domain.</popuptext><run
><font size='9pt'/>Domino domains and aliases:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='36' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>DomainType = "GlobalDomain":"DomainRule"</formula></code></pardef>
<par def='36'><run><font size='9pt'/></run><run><font size='9pt'/><field lookupeachchar='false'
 lookupaddressonrefresh='false' type='names' allowmultivalues='true' kind='editable'
 name='AllowFromDomains' description='Domains that will be allowed to send mail to this domain; none allows all.'
 listinputseparators='comma semicolon newline' listdisplayseparator='semicolon'><code
 event='htmlattributes'><formula>htmlTextArea5L</formula></code><code event='inputtranslation'><formula
>@Trim(AllowFromDomains)</formula></code></field></run><run><font size='9pt'/></run></par>
<pardef id='37' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='37'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 allowmultivalues='true' kind='editable' name='NotesDomainList' description='The list of Domino Domains which belong to this Global Domain.'
 listinputseparators='comma semicolon newline' listdisplayseparator='newline'><code
 event='htmlattributes'><formula>htmlTextArea5L</formula></code><code event='inputtranslation'><formula
>@Trim(NotesDomainList)</formula></code></field></run><compositedata type='98'
 prevtype='65418' nexttype='222' afterparcount='9' containertype='65418' aftercontainercount='1'
 afterbegincount='4'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<pardef id='38' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType = "GlobalDomain":"DomainRule"</formula></code></pardef>
<par def='38'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Domains that will be restricted from sending mail to this domain.</popuptext><run
><font size='9pt'/>Deny mail from domains:</run></popup><run><font size='9pt'/></run></par>
<pardef id='39' leftmargin='0.0597in' rightmargin='100%' keeptogether='true'><code
 event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='39'><run><font size='9pt'/>Alias separator character:</run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='40' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType = "GlobalDomain":"DomainRule"</formula></code></pardef>
<par def='40'><run><font size='9pt'/></run><run><font size='9pt'/><field lookupeachchar='false'
 lookupaddressonrefresh='false' type='names' allowmultivalues='true' kind='editable'
 name='DenyFromDomains' description='Domains that will be restricted from sending mail to this domain; none allows all.'
 listinputseparators='comma semicolon newline' listdisplayseparator='semicolon'><code
 event='htmlattributes'><formula>htmlTextArea5L</formula></code><code event='inputtranslation'><formula
>@Trim(DenyFromDomains)</formula></code></field></run><run><font size='9pt'/></run></par>
<pardef id='41' leftmargin='0.0597in' rightmargin='100%' keeptogether='true'><code
 event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='41'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 kind='editable' name='DomainSeparatorChar' description='Choose the character you want to use to define a Domino Domain alias.'><code
 event='htmlattributes'><formula>htmlInputS</formula></code><code event='defaultvalue'><formula
>"="</formula></code></field></run><compositedata type='98' prevtype='65418'
 nexttype='222' afterparcount='9' containertype='65418' aftercontainercount='1'
 afterbegincount='4'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell></tablerow></table>
<pardef id='42' leftmargin='1%' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>DomainType="DomainRule"</formula></code></pardef>
<par def='42'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow tablabel='Mail Information'>
<tablecell borderwidth='0px' bgcolor='white'>
<pardef id='43' leftmargin='0.1000in' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>DomainType!="ForeignDomain" &amp; DomainType!="ccMailDomain"</formula></code></pardef>
<par def='43'><run><font size='9pt'/></run></par>
<table cellbordercolor='silver' htmlclass='TableSpacing' leftmargin='0.1000in'
 rightmargin='50%' widthtype='fixedleft' rowspacing='0.0201in' refwidth='5.5000in'><tablecolumn
 width='1.5000in'/><tablecolumn width='4in'/>
<tablerow>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='44' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="ForeignDomain" &amp; DomainType!="ccMailDomain"</formula></code></pardef>
<par def='44'><run><font size='9pt' style='bold' color='white'/>Mail</run></par></tablecell>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='45' leftmargin='0.0597in' rightmargin='99%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="ForeignDomain" &amp; DomainType!="ccMailDomain"</formula></code></pardef>
<par def='45'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='46' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>DomainType!="ForeignDomain"</formula></code></pardef>
<par def='46'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Enter the name of the server where the gateway is installed.</popuptext><run
><font size='9pt'/>Gateway server name:</run></popup><run><font size='9pt'/></run><popup
 show='onclick' hotspotstyle='none'><popuptext>Enter the name of the computer to route SMTP mail to.</popuptext><run
><font size='9pt'/></run></popup><run><font size='9pt'/></run></par>
<pardef id='47' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>DomainType!="ccMailDomain"</formula></code></pardef>
<par def='47'><run><font size='9pt'/>cc:Mail MTA server:</run></par></tablecell>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='48' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>DomainType!="ForeignDomain" &amp; DomainType!="ccMailDomain"</formula></code></pardef>
<par def='48'><run><font size='9pt'/></run><run><font size='9pt'/><field lookupeachchar='false'
 lookupaddressonrefresh='false' type='names' kind='editable' name='ForeignDomainMailServer'
 description='Name of server where gateway is installed.'><code event='htmlattributes'><formula
>htmlInputL</formula></code><code event='defaultvalue'><formula>MailServer</formula></code></field></run><run
 html='true'><font size='9pt'/></run><run html='true'><font size='9pt'/><computedtext
><code event='value'><formula>REM {Web address picker};

@If(@ClientType = "Notes" | !@IsDocBeingEdited; @Return(""); "");


_tLabelOneItem	:= "server";


REM {DNT};
_tFieldName	:= "ForeignDomainMailServer";
_tDb   		:= @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");

"&lt;a onclick=\"

	var hDlg = window.hDlgAddrSingle;

	hDlg.sMsgOneEntry	= '"+ _tLabelOneItem +"';
	hDlg.hDestField	= document.forms[0]." + _tFieldName + ";

	hDlg.dlOpen();

	return false;

\" href=\"\"&gt;&lt;img src=\"/" + _tDb + "/btnPicker.gif?OpenImageResource\" width=\"15\" height=\"11\" border=\"0\" alt=\"\"&gt;&lt;/a&gt;"</formula></code></computedtext></run><run
><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<pardef id='49' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="ForeignDomain"</formula></code></pardef>
<par def='49'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Name of gateway's mailbox database file.</popuptext><run><font size='9pt'/>Gateway mail file name:</run></popup><run
><font size='9pt'/></run></par>
<par def='18'><run><font size='9pt'/>Default cc:Mail post office:</run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='50' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="ForeignDomain"</formula></code></pardef>
<par def='50'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 kind='editable' name='MailFile' description='Name of gateway&apos;s mailbox database file.'><code
 event='htmlattributes'><formula>htmlInputL</formula></code><code event='inputtranslation'><formula
>@If(DomainType="ccMailDomain";"ccmail.box";@Trim(MailFile))</formula></code><code
 event='inputvalidation'><formula>L_ERR_MSG := "You must supply a Gateway mail file name before saving this document.";

sMsg := @If(DomainType="ForeignDomain" &amp; MailFile=""; L_ERR_MSG; "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='9' containertype='65418'
 aftercontainercount='1' afterbegincount='4'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par>
<pardef id='51' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="ccMailDomain"</formula></code></pardef>
<par def='51'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 kind='editable' name='DefaultPostOffice'><code event='htmlattributes'><formula
>htmlInputL</formula></code></field></run><compositedata type='98' prevtype='65418'
 nexttype='222' afterparcount='9' containertype='65418' aftercontainercount='1'
 afterbegincount='4'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell></tablerow></table>
<pardef id='52' leftmargin='1%' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>DomainType!="ForeignDomain" &amp; DomainType!="ccMailDomain"</formula></code></pardef>
<par def='52'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow tablabel='Calendar Information'>
<tablecell borderwidth='0px' bgcolor='white'>
<pardef id='53' leftmargin='0.1000in' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>@IsNotMember(DomainType;"ForeignDomain":"AdjacentDomain":"NonAdjacentDomain")</formula></code></pardef>
<par def='53'><run><font size='9pt'/></run></par>
<table cellbordercolor='silver' htmlclass='TableSpacing' leftmargin='0.1000in'
 rightmargin='50%' widthtype='fixedleft' rowspacing='0.0201in' refwidth='5.5000in'><tablecolumn
 width='1.5000in'/><tablecolumn width='4in'/>
<tablerow>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='54' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"ForeignDomain":"AdjacentDomain":"NonAdjacentDomain")</formula></code></pardef>
<par def='54'><run><font size='9pt' style='bold' color='white'/>Calendar</run></par></tablecell>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='55' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"ForeignDomain":"AdjacentDomain":"NonAdjacentDomain")</formula></code></pardef>
<par def='55'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='56' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"ForeignDomain":"AdjacentDomain")</formula></code></pardef>
<par def='56'><run><font size='9pt'/>Calendar server name:</run></par>
<pardef id='57' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="NonAdjacentDomain"</formula></code></pardef>
<par def='57'><run><font size='9pt'/>Route requests through calendar server:</run></par></tablecell>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='58' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"ForeignDomain":"AdjacentDomain":"NonAdjacentDomain")</formula></code></pardef>
<par def='58'><run><font size='9pt'/></run><run><font size='9pt'/><field lookupeachchar='false'
 lookupaddressonrefresh='false' type='names' allowmultivalues='true' kind='editable'
 name='CalendarServer' listinputseparators='comma semicolon newline' listdisplayseparator='newline'><code
 event='htmlattributes'><formula>htmlTextArea2L</formula></code></field></run><run
 html='true'><font size='9pt'/></run><run html='true'><font size='9pt'/><computedtext
><code event='value'><formula>REM {Web address picker};

@If(@ClientType = "Notes" | !@IsDocBeingEdited; @Return(""); "");


_tLabelOneItem	:= "server";


REM {DNT};
_tFieldName	:= "CalendarServer";
_tDb   		:= @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");

"&lt;a onclick=\"

	var hDlg = window.hDlgAddrSingle;

	hDlg.sMsgOneEntry	= '"+ _tLabelOneItem +"';
	hDlg.hDestField	= document.forms[0]." + _tFieldName + ";

	hDlg.dlOpen();

	return false;

\" href=\"\"&gt;&lt;img src=\"/" + _tDb + "/btnPicker.gif?OpenImageResource\" width=\"15\" height=\"11\" border=\"0\" alt=\"\"&gt;&lt;/a&gt;"</formula></code></computedtext></run><run
><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<pardef id='59' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="ForeignDomain"</formula></code></pardef>
<par def='59'><run><font size='9pt'/>Calendar system:</run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='60' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="ForeignDomain"</formula></code></pardef>
<par def='60'><run><font size='9pt'/></run><run><font size='9pt'/><field type='keyword'
 kind='editable' name='CalendarSystem'><keywords ui='dialoglist' allownew='true'><formula
>"" : "OfficeVision|LCCOV" : "Organizer 2.x|ORG21BT"</formula></keywords><code
 event='inputvalidation'><formula>L_ERR_MSG := "You must enter a Calendar System if specifying a Calendar Server.";

sMsg := @If(DomainType="ForeignDomain" &amp; CalendarServer!="" &amp;CalendarSystem = ""; L_ERR_MSG; "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><run
><font size='9pt'/></run></par></tablecell></tablerow></table>
<pardef id='61' leftmargin='1%' rightmargin='97%' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>@IsNotMember(DomainType;"ForeignDomain":"AdjacentDomain":"NonAdjacentDomain")</formula></code></pardef>
<par def='61'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow tablabel='Conversions'>
<tablecell borderwidth='0px' bgcolor='white'>
<pardef id='62' leftmargin='0.1000in' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='62'><run><font size='9pt'/></run></par>
<table widthtype='fitmargins' cellbordercolor='silver' htmlid='DomainTable'
 htmlclass='TableSpacing' leftmargin='0.1000in' rightmargin='99%' rowspacing='0.0201in'
 refwidth='8.1382in'><tablecolumn width='14.2917%'/><tablecolumn width='42.6701%'/><tablecolumn
 width='0.1250in'/><tablecolumn width='1.5000in'/><tablecolumn width='43.0417%'/>
<tablerow>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='64' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='64'><run><font size='9pt' style='bold' color='white'/>SMTP Address Conversion</run></par></tablecell>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='65' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='65'><run><font size='9pt' style='bold' color='white'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<pardef id='66' leftmargin='0.0597in' rightmargin='40%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='66'><run><font size='9pt' color='white'/></run></par></tablecell>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='67' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='67'><run><font size='9pt' style='bold' color='white'/>X.400 Address Conversion</run></par></tablecell>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='68' leftmargin='0.0597in' rightmargin='100%' keeptogether='true'><code
 event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='68'><run><font size='9pt' style='bold' color='#f7f7f7'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='69' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='69'><run><font size='9pt'/>Local primary </run><popup show='onclick'
 hotspotstyle='none'><popuptext>Specify the Internet domain suffix. </popuptext><run
><font size='9pt'/>Internet domain:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='70' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='70'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 kind='editable' name='LocalPrimaryInternetDomain'><code event='htmlattributes'><formula
>htmlInputL</formula></code><code event='defaultvalue'><formula>@Subset(SMTPDomainSuffixes;1)</formula></code><code
 event='inputvalidation'><formula>REM { only require if global domain and if SMTP is specified as a role and they specify an alias};
sMsg := @If(DomainType!="GlobalDomain"; "";
@If(@IsMember("SMTP";GlobalDomainTasks)
     &amp; LocalPrimaryInternetDomain="" &amp; LocalInternetDomainAliases!="";
    "You must enter a primary Internet domain if you are going to also list aliases.";
    @Length(LocalPrimaryInternetDomain) &gt;100; "Internet domain names cannot be greater than 100 characters."; ""));

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='9' containertype='65418'
 aftercontainercount='1' afterbegincount='4'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<pardef id='71' leftmargin='0.0597in' rightmargin='78%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='71'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='72' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='72'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Specify whether messages to an X.400 destination may only be sent from Domino domains within this Global Domain.</popuptext><run
><font size='9pt'/>Outbound mail restriction</run></popup><run><font size='9pt'/>:</run></par></tablecell>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='73' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='73'><run><font size='9pt'/></run><run><font size='9pt'/><field lookupeachchar='false'
 lookupaddressonrefresh='false' type='keyword' kind='editable' name='X400OutbMailRestriction'
 description='Specify whether messages to an X.400 destination may only be sent from Domino domains within this Global Domain.'><keywords
 columns='1' ui='dialoglist'><textlist><text>Restrict to global domain|1</text><text
>Unrestricted|0</text></textlist></keywords><code event='htmlattributes'><formula
>htmlSelectL</formula></code><code event='defaultvalue'><formula>"1"</formula></code></field></run><run
><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<par def='64'><run><font size='9pt'/>Alternate Internet domain aliases:</run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='65'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 allowmultivalues='true' kind='editable' name='LocalInternetDomainAliases'
 listinputseparators='comma semicolon newline' listdisplayseparator='newline'><code
 event='htmlattributes'><formula>htmlTextarea2L</formula></code><code event='defaultvalue'><formula
>@If(@Elements(SMTPDomainSuffixes)&gt;1;@Subset(SMTPDomainSuffixes;-(@Elements(SMTPDomainSuffixes)-1));"")</formula></code><code
 event='inputvalidation'><formula>L_ERR_MSG := "Internet domain names cannot be greater than 100 characters.";

sMsg := @If(@Length(LocalInternetDomainAliases)&gt;100; L_ERR_MSG; "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='8' containertype='65418'
 aftercontainercount='1' afterbegincount='4'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<pardef id='74' leftmargin='0.0597in' rightmargin='78%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='74'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='67'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Specify the two character alphabetic X.400 country code to be included in the sender's X.400 O/R address.</popuptext><run
><font size='9pt'/>Country name:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='75' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='75'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 kind='editable' name='X400Country' description='Specify the two character alphabetic X.400 country code to be included in the sender&apos;s X.400 O/R address.'><code
 event='htmlattributes'><formula>htmlInputL</formula></code><code event='inputtranslation'><formula
>@Trim(@UpperCase(X400Country))</formula></code><code event='inputvalidation'><formula
>L_ERR_MSG := "You must enter a valid Country code.";
L_ERR_MSG2 := "The Country attribute must have a length of 2 characters.";
L_ERR_MSG3 := "The Country attribute can only contain the letters A-Z.";

sMsg := @If(@IsMember("X400";GlobalDomainTasks); @If(DomainType="GlobalDomain"; @If(X400Country = "" ;L_ERR_MSG; @Length(X400Country) &gt; 2|@Length(X400Country)&lt;2; L_ERR_MSG2; @Matches(@Left(X400Country;1);"{A-Z}")&amp;
@Matches(@Right(X400Country;1);"{A-Z}"); "";  L_ERR_MSG3); ""); "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='9' containertype='65418'
 aftercontainercount='1' afterbegincount='4'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<pardef id='76' leftmargin='0.0597in' rightmargin='100%' spaceafter='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='76'><run><font size='9pt'/>Internet address lookup:</run></par>
<par def='64'><run><font size='9pt'/>   </run><run><font size='9pt' style='italic'/>If disabled or no match,</run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='77' leftmargin='0.0597in' rightmargin='100%' spaceafter='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='77'><run><font size='9pt'/></run><run><font size='9pt'/><field type='keyword'
 kind='editable' name='SMTPAddrLookup'><keywords ui='dialoglist'><textlist
><text>Enabled|1</text><text>Disabled|0</text></textlist></keywords><code
 event='defaultvalue'><formula>"0"</formula></code></field></run><run><font
 size='9pt'/></run></par>
<par def='77'><run><font size='9pt' style='italic'/>convert as follows:</run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='74'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='67'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Specify the X.400  Administration Management Domain to be included in the sender's X.400 O/R address.</popuptext><run
><font size='9pt'/>ADMD name:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='75'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 kind='editable' name='X400ADMD' description='Specify the X.400  Administration Management Domain to be included in the sender&apos;s X.400 O/R address.'><code
 event='htmlattributes'><formula>htmlInputL</formula></code><code event='inputtranslation'><formula
>@If(X400ADMD=" "; X400ADMD;@Trim(X400ADMD))</formula></code><code event='inputvalidation'><formula
>L_ERR_MSG := "The ADMD maximum length is 16 characters.";
L_ERR_MSG2 := "The ADMD is missing or  contains an invalid character, please re-enter. Enter a single space to support a single space ADMD.";
L_ERR_MSG3 := "You must specify either a valid ADMD or a single space.";

sMsg := @If(@IsMember("X400";GlobalDomainTasks); @If(DomainType="GlobalDomain"; @If (@Length(X400ADMD) &gt; 16 ;L_ERR_MSG; @Ascii(X400ADMD;[AllInRange])=""; L_ERR_MSG2; (X400ADMD=""| @IsUnavailable(X400ADMD)); L_ERR_MSG3; ""); ""); "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='8' containertype='65418'
 aftercontainercount='1' afterbegincount='4'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par>
<pardef id='78' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>X400ADMD!=" "</formula></code></pardef>
<par def='78'><run><font size='9pt'/>(ADMD = single space)</run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<par def='64'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Specify how the local part of a sender's Internet address will be constructed, when sending to the Internet.</popuptext><run
><font size='9pt'/>Local part formed from:</run></popup><run><font size='9pt'
 style='italic'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='65'><run><font size='9pt'/></run><run><font size='9pt'/><field lookupeachchar='false'
 lookupaddressonrefresh='false' type='keyword' kind='editable' name='SMTPLocalPart'
 description='Specify how the local part of a sender&apos;s Internet address will be constructed, when sending to the Internet.'><keywords
 columns='1' ui='dialoglist'><textlist><text>Full name|0</text><text>Common name|1</text><text
>Short name|2</text></textlist></keywords><code event='htmlattributes'><formula
>htmlSelectL</formula></code><code event='defaultvalue'><formula>"0"</formula></code><code
 event='inputvalidation'><formula>L_ERR_MSG := "You must enter a value in the 'Local part formed from' field.";

sMsg := @If(@IsMember("SMTP";GlobalDomainTasks); @If(SMTPLocalPart="" &amp; DomainType="GlobalDomain"; L_ERR_MSG; ""); "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><run
><font size='9pt' style='italic'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='74'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='67'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Specify the X.400 Private Management Domain to be included in the sender's X.400 O/R address.</popuptext><run
><font size='9pt'/>PRMD name:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='75'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 kind='editable' name='X400Domain' description='Specify the X.400 Private Management Domain to be included in the sender&apos;s X.400 O/R address.'><code
 event='htmlattributes'><formula>htmlInputL</formula></code><code event='inputtranslation'><formula
>@Trim(X400Domain)</formula></code><code event='inputvalidation'><formula
>L_ERR_MSG := "A valid PRMD must be entered to support a single space ADMD.";
L_ERR_MSG2 := "The PRMD maximum length is 16 characters.";
L_ERR_MSG3 := "The PRMD field contains an invalid character, please re-enter.";

sMsg := @If(@IsMember("X400";GlobalDomainTasks); @If(DomainType="GlobalDomain"; @If(X400ADMD=" " &amp; X400Domain=""; L_ERR_MSG; @Length(X400Domain) &gt; 16; L_ERR_MSG2; @Length(X400Domain) &gt; 0 &amp; @Ascii(X400Domain;[AllInRange])=""; L_ERR_MSG3; ""); ""); "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='8' containertype='65418'
 aftercontainercount='1' afterbegincount='4'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<par def='64'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Specify the number of Domino domains to include in the sender's Internet address.</popuptext><run
><font size='9pt'/>Domino domain(s) included:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='65'><run><font size='9pt'/></run><run><font size='9pt'/><field lookupeachchar='false'
 lookupaddressonrefresh='false' type='keyword' kind='editable' name='SMTPNotesDomainIncluded'
 description='Specify the number of Domino domains to include in the sender&apos;s Internet address.'><keywords
 recalconchange='true' columns='1' ui='dialoglist'><textlist><text>None|0</text><text
>One|1</text><text>All|99</text></textlist></keywords><code event='htmlattributes'><formula
>htmlSelectL</formula></code><code event='defaultvalue'><formula>"99"</formula></code><code
 event='inputvalidation'><formula>L_ERR_MSG := "You must enter a value in the 'Domino domain(s) included' field.";

sMsg := @If(@IsMember("SMTP";GlobalDomainTasks); @If(SMTPNotesDomainIncluded="" &amp; DomainType="GlobalDomain"; L_ERR_MSG; ""); "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><run
><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='74'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='67'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Enter the attribute you want the Domino Domain name to appear on outgoing X.400 mail. Enter None if you do not want the Domino domain name to appear in outgoing X.400 mail.</popuptext><run
><font size='9pt'/>Domino domain attribute:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='75'><run><font size='9pt'/></run><run><font size='9pt'/><field lookupeachchar='false'
 lookupaddressonrefresh='false' type='keyword' kind='editable' name='X400ChooseDomainAttribute'
 description='Enter the attribute you want the Domino domain name to appear in outgoing X.400 mail.'><keywords
 recalconchange='true' columns='1' ui='dialoglist'><textlist><text>Organization|O</text><text
>Organizational Unit 1|OU1</text><text>Organizational Unit 2|OU2</text><text
>Organizational Unit 3|OU3</text><text>Organizational Unit 4|OU4</text><text
>Domain Defined Attribute|DDA1</text><text>None|NULL</text></textlist></keywords><code
 event='htmlattributes'><formula>htmlSelectL</formula></code><code event='defaultvalue'><formula
>"NULL"</formula></code></field></run><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<par def='64'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Specify the whether the Domino domains included in a sender's address will be placed before or after the '@' character.</popuptext><run
><font size='9pt'/>Domino domain(s) position</run></popup><run><font size='9pt'/>:</run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='65'><run><font size='9pt'/></run><run><font size='9pt'/><field lookupeachchar='false'
 lookupaddressonrefresh='false' type='keyword' kind='editable' name='SMTPNotesDomainPos'
 description='Specify whether the Domino domains included in a sender&apos;s address will be placed before or after the &apos;@&apos;.'><keywords
 recalconchange='true' columns='1' ui='dialoglist'><textlist><text>Left of '@'|1</text><text
>Right of '@'|2</text></textlist></keywords><code event='htmlattributes'><formula
>htmlSelectL</formula></code><code event='defaultvalue'><formula>"1"</formula></code><code
 event='inputvalidation'><formula>L_ERR_MSG := "You must enter a value in the 'Domino domain(s) position' field.";

sMsg := @If(@IsMember("SMTP";GlobalDomainTasks); @If(SMTPNotesDomainPos="" &amp; DomainType="GlobalDomain"; L_ERR_MSG; ""); "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><run
><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='74'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='79' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>X400ChooseDomainAttribute!="DDA1"</formula></code></pardef>
<par def='79'><run><font size='9pt'/>DDA type:</run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='80' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>X400ChooseDomainAttribute!="DDA1"</formula></code></pardef>
<par def='80'><run><font size='9pt' style='bold'/></run><run><font size='9pt'/><field
 type='text' kind='editable' name='X400DomainDefinedAttribute' description='Specify the X.400 domain defined attribute type to carry the Domino domain. The default is "LD".'><code
 event='htmlattributes'><formula>htmlInputL</formula></code><code event='defaultvalue'><formula
>"LD"</formula></code><code event='inputvalidation'><formula>L_ERR_MSG := "You must specify a Domain defined attribute type if the X.400 Domino domain attribute selected is 'Domain Defined Attribute'";
L_ERR_MSG2 := "The Domain defined attribute type maximum length is 8 characters";

sMsg := @If(@IsMember("X400";GlobalDomainTasks); @If((X400DomainDefinedAttribute="" &amp; X400ChooseDomainAttribute="DDA1"); L_ERR_MSG; @Length(X400DomainDefinedAttribute) &gt; 8; L_ERR_MSG2; ""); "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='9' containertype='65418'
 aftercontainercount='1' afterbegincount='4'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px' htmlid='DomainTable_a'>
<par def='64'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Specify the character to be used to separate Domino Domain names in a sender's address.</popuptext><run
><font size='9pt'/>Domino domain separator:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='65'><run><font size='9pt'/></run><run><font size='9pt'/><field lookupeachchar='false'
 lookupaddressonrefresh='false' type='keyword' kind='editable' name='SMTPNotesDomainSepChar'
 description='Specify the character to be used to separate Domino Domain names in a sender&apos;s address.'><keywords
 recalconchange='true' columns='1' ui='dialoglist'><textlist><text>% - percent sign|%</text><text
>. - period|.</text></textlist></keywords><code event='htmlattributes'><formula
>htmlSelectL</formula></code><code event='defaultvalue'><formula>"%"</formula></code><code
 event='inputvalidation'><formula>L_ERR_MSG := "You must enter a value in the 'Domino domain separator' field.";

sMsg := @If(@IsMember("SMTP";GlobalDomainTasks); @If(SMTPNotesDomainSepChar="" &amp; DomainType="GlobalDomain"; L_ERR_MSG; ""); "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><run
><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='74'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='81' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='81'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='82' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='82'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<par def='64'><run><font size='9pt'/>Address example:</run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='65'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 kind='computedfordisplay' name='SMTPAddressExamples'><code event='defaultvalue'><formula
>a:=SMTPNotesDomainIncluded;
b:=SMTPNotesDomainSepChar;
c:=SMTPNotesDomainPos;
d:=SMTP822Format;
REM {a= None|0; One|1, All|99};
REM {b= %; . (period) This parameter is ignored when parameter 1 is set to None.};
REM {c= Left of @|1; Right of @|2 This parameter is ignored when parameter 1 is set to None.};
REM {d= Address only|1; Name and Address|2};

REM {These examples assume that the parameter 'Local part constructed from' is specified to be the short name.  When mail is from another domain, it is likely that we will not have access to the Person record in the N&amp;A Book and therefore will not be able to retrieve the Short Name.  Therefore, the following examples which include a domain string may be misleading.  However, I'm on the fence with this.};


@If(
a="0" &amp; d="1";"JMD@acme.com";
a="1" &amp; b="%" &amp; c="1" &amp; d="1";"JMD%dom1@acme.com";
a="99"&amp;b="%"&amp;c="1"&amp;d="1";"JMD%dom1%dom2%dom3@acme.com";
a="0"&amp;b="%"&amp;c="2"&amp;d="1";"JMD@acme.com";
a="1"&amp;b="%"&amp;c="2"&amp;d="1";"ERROR: Invalid parameter combination:  Position \"Right of @\" with Separator \"%\"";
a="99"&amp;b="%"&amp;c="2"&amp;d="1";"ERROR: Invalid parameter combination:  Position \"Right of @\" with Separator \"%\"";
a="0"&amp;b="%"&amp;c="1"&amp;d="2";"\"Jane M. Doe\" &lt;JMD@acme.com&gt;";
a="1"&amp;b="%"&amp;c="1"&amp;d="2";"\"Jane M. Doe\" &lt;JMD%dom1@acme.com&gt;";
a="99"&amp;b="%"&amp;c="1"&amp;d="2";"\"Jane M. Doe\" &lt;JMD%dom1%dom2%dom3@acme.com&gt;";
a="0"&amp;b="%"&amp;c="2"&amp;d="2";"\"Jane M. Doe\" &lt;JMD@acme.com&gt;";
a="1"&amp;b="%"&amp;c="2"&amp;d="2";"ERROR: Invalid parameter combination:  Position \"Right of @\" with Separator \"%\"";
a="99"&amp;b="%"&amp;c="2"&amp;d="2";"ERROR: Invalid parameter combination:  Position \"Right of @\" with Separator \"%\"";
a="0"&amp;b="."&amp;c="1"&amp;d="1";"JMD@acme.com";
a="1"&amp;b="."&amp;c="1"&amp;d="1";"JMD.dom1@acme.com";
a="99"&amp;b="."&amp;c="1"&amp;d="1";"JMD.dom1.dom2.dom3@acme.com";
a="0"&amp;b="."&amp;c="2"&amp;d="1";"JMD@acme.com";
a="1"&amp;b="."&amp;c="2"&amp;d="1";"JMD@dom1.acme.com";
a="99"&amp;b="."&amp;c="2"&amp;d="1";"JMD@dom1.dom2.dom3.acme.com";
a="0"&amp;b="."&amp;c="1"&amp;d="2";"\"Jane M. Doe\" &lt;JMD@acme.com&gt;";
a="1"&amp;b="."&amp;c="1"&amp;d="2";"\"Jane M. Doe\" &lt;JMD.dom1@acme.com&gt;";
a="99"&amp;b="."&amp;c="1"&amp;d="2";"\"Jane M. Doe\" &lt;JMD.dom1.dom2.dom3@acme.com&gt;";
a="0"&amp;b="."&amp;c="2"&amp;d="2";"\"Jane M. Doe\" &lt;JMD@acme.com&gt;";
a="1"&amp;b="."&amp;c="2"&amp;d="2";"\"Jane M. Doe\" &lt;JMD@dom1.acme.com&gt;";
a="99"&amp;b="."&amp;c="2"&amp;d="2";"\"Jane M. Doe\" &lt;JMD@dom1.dom2.dom3.acme.com&gt;";
"")</formula></code></field></run><compositedata type='98' prevtype='65418'
 nexttype='222' afterparcount='7' containertype='65418' aftercontainercount='1'
 afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='74'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px 0px'>
<par def='81'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px 0px'>
<par def='75'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell columnspan='2' borderwidth='1px 0px'>
<pardef id='83' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='83'><run><font size='9pt'/>NOTE:  The following settings are not used in R5, R6, or R7.   They only apply to R4.x SMTP MTAs</run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='74'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='81'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='75'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<pardef id='84' leftmargin='0.0597in' rightmargin='98%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='84'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Specify whether messages to the Internet may only be sent from Domino domains within this Global Domain.</popuptext><run
><font size='9pt'/>Outbound mail restriction:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='65'><run><font size='9pt'/></run><run><font size='9pt'/><field lookupeachchar='false'
 lookupaddressonrefresh='false' type='keyword' kind='editable' name='SMTPOutbMailRestriction'
 description='Specify whether messages to the Internet may only be sent from Domino domains within this Global Domain.'><keywords
 columns='1' ui='dialoglist'><textlist><text>Restrict to global domain|1</text><text
>Unrestricted|0</text></textlist></keywords><code event='htmlattributes'><formula
>htmlSelectL</formula></code><code event='defaultvalue'><formula>"0"</formula></code><code
 event='inputvalidation'><formula>L_ERR_MSG := "You must enter a value in the 'Outbound mail restriction' field.";

sMsg := @If(@IsMember("SMTP";GlobalDomainTasks); @If(SMTPOutbMailRestriction="" &amp; DomainType="GlobalDomain"; L_ERR_MSG; ""); "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><run
><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='74'><run><font size='9pt' style='bold'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='81'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='75'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<par def='64'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Specify the format of the sender's address.</popuptext><run><font size='9pt'/>Address format:</run></popup><run
><font size='9pt'/> </run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='65'><run><font size='9pt'/></run><run><font size='9pt'/><field lookupeachchar='false'
 lookupaddressonrefresh='false' type='keyword' kind='editable' name='SMTP822Format'
 description='Specify the format of the sender&apos;s address.'><keywords
 recalconchange='true' columns='1' ui='dialoglist'><textlist><text>Address only|1</text><text
>Name and Address|2</text></textlist></keywords><code event='htmlattributes'><formula
>htmlSelectL</formula></code><code event='defaultvalue'><formula>"1"</formula></code><code
 event='inputvalidation'><formula>L_ERR_MSG := "You must enter a value in the 'Address format' field.";

sMsg := @If(@IsMember("SMTP";GlobalDomainTasks); @If(SMTP822Format="" &amp; DomainType="GlobalDomain"; L_ERR_MSG; ""); "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><run
><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='74'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='81'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='75'><run><font size='9pt'/></run></par></tablecell></tablerow></table>
<pardef id='85' leftmargin='1%' rightmargin='100%' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>DomainType!="GlobalDomain"</formula></code></pardef>
<par def='85'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow tablabel='Routing'>
<tablecell borderwidth='0px' bgcolor='white'>
<pardef id='86' leftmargin='0.1000in' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule":"SMTPDomain")</formula></code></pardef>
<par def='86'><run><font size='9pt'/></run></par>
<table widthtype='fitmargins' cellbordercolor='silver' htmlid='DomainTable1'
 htmlclass='TableSpacing' leftmargin='0.1000in' rightmargin='99%' rowspacing='0.0201in'
 refwidth='8.2229in'><tablecolumn width='1.5000in'/><tablecolumn width='3.1000in'/><tablecolumn
 width='0.1250in'/><tablecolumn width='1.5000in'/><tablecolumn width='100%'/>
<tablerow>
<tablecell borderwidth='0px' bgcolor='#b1b1d2' htmlid='DomainTable1_a'>
<pardef id='87' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule":"SMTPDomain")</formula></code></pardef>
<par def='87'><run><font size='9pt' style='bold' color='white'/>Messages Addressed to:</run></par></tablecell>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='88' leftmargin='0.0597in' rightmargin='100%' keeptogether='true'><code
 event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule":"SMTPDomain")</formula></code></pardef>
<par def='88'><run><font size='9pt' style='bold' color='white'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<pardef id='89' leftmargin='0.0597in' rightmargin='78%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule":"SMTPDomain")</formula></code></pardef>
<par def='89'><run><font size='9pt' color='white'/></run></par></tablecell>
<tablecell valign='center' borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='90' leftmargin='0.0597in' rightmargin='100%' keeptogether='true'><code
 event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule":"SMTPDomain")</formula></code></pardef>
<par def='90'><run><font size='9pt' style='bold' color='white'/>Should be Routed to:</run></par></tablecell>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='91' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule":"SMTPDomain")</formula></code></pardef>
<par def='91'><run><font size='9pt' color='white'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='0px 0px 1px' htmlid='DomainTable1_b'>
<pardef id='92' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule")</formula></code></pardef>
<par def='92'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Country name (e.g., US, UK).  * means any country.</popuptext><run><font
 size='9pt'/>Country:</run></popup><run><font size='9pt'/></run></par>
<pardef id='93' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"SMTPDomain")</formula></code></pardef>
<par def='93'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Specify an Internet domain containing either an explicit name or the wild card symbol "*".  (e.g. *.company.com  ,  *.* , etc.)</popuptext><run
><font size='9pt'/>Internet Domain</run></popup><run><font size='9pt'/>:</run></par></tablecell>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='94' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule")</formula></code></pardef>
<par def='94'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 kind='editable' name='Country' description='Specify the two character alphabetic X.400 country code to use in routing rules.  * means any country.'><code
 event='defaultvalue'><formula>"*"</formula></code><code event='inputtranslation'><formula
>@If(Country = "" : " "; "*"; @Trim(@UpperCase(Country)))</formula></code><code
 event='inputvalidation'><formula>L_ERR_MSG := "The Country attribute must have a length of 2 characters.";
L_ERR_MSG2 := "The Country attribute can only contain the letters A-Z.";

sMsg := @If(Country ="*"; "";
		@Length(Country) &gt; 2|@Length(Country)&lt;2; L_ERR_MSG;
		@Matches(@Left(Country;1);"{A-Z}") &amp; @Matches(@Right(Country;1);"{A-Z}"); "";
		L_ERR_MSG2);

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='8' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par>
<pardef id='95' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"SMTPDomain")</formula></code></pardef>
<par def='95'><run><font size='9pt'/></run><run><font size='9pt'/><field type='text'
 kind='editable' name='SMTPDomainName' description='Specify an Internet domain containing either an explicit name or the wild card symbol "*".  (e.g. *.company.com  ,  *.* , etc.)'><code
 event='inputvalidation'><formula>L_ERR_MSG := "You must enter a valid Internet Domain name before you can save this document.";

sMsg := @If(DomainType="SMTPDomain" &amp; SMTPDomainName=""; L_ERR_MSG; "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='8' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<pardef id='96' leftmargin='0.0597in' rightmargin='78%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule":"SMTPDomain")</formula></code></pardef>
<par def='96'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='97' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule":"SMTPDomain")</formula></code></pardef>
<par def='97'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
> Next domain name.</popuptext><run><font size='9pt'/>Domain name:</run></popup><run
><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px 0px 1px'>
<pardef id='98' leftmargin='0.0597in' rightmargin='100%' spacebefore='1.5'
 keepwithnext='true' keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule":"SMTPDomain")</formula></code></pardef>
<par def='98'><run><font size='9pt'/></run><run><font size='9pt'/><field type='names'
 allowmultivalues='true' kind='editable' name='DomainRuleNextDomain' description=' Next domain name.'
 listinputseparators='comma semicolon' listdisplayseparator='semicolon'><code
 event='inputtranslation'><formula>@Trim(DomainRuleNextDomain)</formula></code></field></run><run
><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px' htmlid='DomainTable1_c'>
<pardef id='99' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule")</formula></code></pardef>
<par def='99'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Administration domain name. * means any ADMD.</popuptext><run><font size='9pt'/>ADMD:</run></popup><run
><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='100' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule")</formula></code></pardef>
<par def='100'><run><font size='9pt'/></run><run><font size='9pt'/><field
 type='text' kind='editable' name='ADMD' description='Specify the Administration Management Domain to use in X.400 routing rules. * means any ADMD.'><code
 event='defaultvalue'><formula>"*"</formula></code><code event='inputtranslation'><formula
>@If(ADMD= "" : " "; "*"; @Trim(ADMD))</formula></code><code event='inputvalidation'><formula
>L_ERR_MSG := "The ADMD maximum length is 16 characters.";
L_ERR_MSG2 := "The ADMD field contains an invalid character, please re-enter.";

sMsg := @If(ADMD= "*"; "";@Length(ADMD) &gt; 16 ; L_ERR_MSG; @Ascii(ADMD;[AllInRange])=""; L_ERR_MSG2; "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='8' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='89'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='101' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule":"SMTPDomain")</formula></code></pardef>
<par def='101'><run><font size='9pt'/>or, </run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='102' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule":"SMTPDomain")</formula></code></pardef>
<par def='102'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px' htmlid='DomainTable1_d'>
<par def='99'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Private management domain name. * means any PRMD.</popuptext><run><font size='9pt'/>PRMD:</run></popup><run
><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='100'><run><font size='9pt'/></run><run><font size='9pt'/><field
 type='text' kind='editable' name='PRMD' description='Specify the Private Management Domain name to use in routing rules. * means any PRMD.'><code
 event='defaultvalue'><formula>"*"</formula></code><code event='inputtranslation'><formula
>@If(PRMD= "" : " "; "*"; @Trim(PRMD))</formula></code><code event='inputvalidation'><formula
>L_ERR_MSG := "The PRMD maximum length is 16 characters.";
L_ERR_MSG2 := "The PRMD field contains an invalid character, please re-enter.";

sMsg := @If(PRMD="*"; "";@Length(X400Domain) &gt; 16 ; L_ERR_MSG; @Length(X400Domain) &gt; 0 &amp; @Ascii(X400Domain;[AllInRange])=""; L_ERR_MSG2; "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='7' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='89'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='103' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule")</formula></code></pardef>
<par def='103'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'
 regionid='1'><popuptext>Name of server or host where mail addressed to the specified domain should be routed.</popuptext><run
><font size='9pt'/>Server name:</run></popup></par>
<pardef id='104' leftmargin='0.0597in' rightmargin='100%' keeptogether='true'><code
 event='hidewhen'><formula>@IsNotMember(DomainType;"SMTPDomain")</formula></code></pardef>
<par def='104'><region regionid='1' end='true'><run><font size='9pt'/>Internet host:</run></region><run
><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='91'><run><font size='9pt'/></run><run><font size='9pt'/><field type='names'
 kind='editable' name='DomainRuleMailServer' description='Name of server or host where mail addressed to the specifed domain should be routed.'><code
 event='inputtranslation'><formula>@Trim(DomainRuleMailServer)</formula></code><code
 event='inputvalidation'><formula>sMsg := @If(DomainRuleNextDomain!="" &amp; DomainRuleMailServer!="" &amp; DomainType="DomainRule";
		"You can only specify either a Domain name or a Server name.";
		DomainRuleNextDomain!="" &amp; DomainRuleMailServer!="" &amp; DomainType="SMTPDomain";
		"You can only specify either a Domain name or a Internet host.";
		DomainRuleNextDomain = "" &amp; DomainRuleMailServer = "" &amp; DomainType="DomainRule";
		"You must enter either a Domain or Server name if routing rules are specified.";
		"");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><run
><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px' htmlid='DomainTable1_e'>
<par def='99'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Organization name. * means any organization.</popuptext><run><font size='9pt'/>Organization:</run></popup><run
><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='100'><run><font size='9pt'/></run><run><font size='9pt'/><field
 type='text' kind='editable' name='Org' description='Specify the X.400 Organization name to use in routing rules. * means any organization.'><code
 event='defaultvalue'><formula>"*"</formula></code><code event='inputtranslation'><formula
>@If(Org= "" : " "; "*"; @Trim(Org))</formula></code><code event='inputvalidation'><formula
>L_ERR_MSG := "The maximum length of an organization is 64 bytes.";

sMsg := @If(@Length(Org)&gt;64; L_ERR_MSG; "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='7' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='89'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px 0px'>
<pardef id='105' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'><code event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule":"SMTPDomain")</formula></code></pardef>
<par def='105'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px 0px'>
<par def='91'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px' htmlid='DomainTable1_f'>
<par def='99'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Organization unit 1. * means any organization unit.</popuptext><run><font
 size='9pt'/>Org Unit 1:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='100'><run><font size='9pt'/></run><run><font size='9pt'/><field
 type='text' kind='editable' name='OrgUnit1' description='Specify the X.400 Organizational unit to use in routing rules. * means any organizational unit.'><code
 event='defaultvalue'><formula>"*"</formula></code><code event='inputtranslation'><formula
>@If(OrgUnit1= "" : " "; "*"; @Trim(OrgUnit1))</formula></code><code event='inputvalidation'><formula
>L_ERR_MSG := "The maximum length of an organizational unit is 32 bytes.";

sMsg := @If(@Length(OrgUnit1)&gt;32; L_ERR_MSG; "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='7' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='89'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='105'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='91'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px' htmlid='DomainTable1_g'>
<par def='99'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Organization unit 2. * means any organization unit.</popuptext><run><font
 size='9pt'/>Org Unit 2:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='100'><run><font size='9pt'/></run><run><font size='9pt'/><field
 type='text' kind='editable' name='OrgUnit2' description='Specify the X.400 Organizational unit to use in routing rules. * means any organizational unit.'><code
 event='defaultvalue'><formula>"*"</formula></code><code event='inputtranslation'><formula
>@If(OrgUnit2= "" : " "; "*"; @Trim(OrgUnit2))</formula></code><code event='inputvalidation'><formula
>L_ERR_MSG := "The maximum length of an organizational unit is 32 bytes.";

sMsg := @If(@Length(OrgUnit2)&gt;32; L_ERR_MSG; "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='7' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='89'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='105'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='91'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px' htmlid='DomainTable1_h'>
<par def='99'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Organization unit 3. * means any organization unit.</popuptext><run><font
 size='9pt'/>Org Unit 3:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='100'><run><font size='9pt'/></run><run><font size='9pt'/><field
 type='text' kind='editable' name='OrgUnit3' description='Specify the X.400 Organizational unit to use in routing rules. * means any organizational unit.'><code
 event='defaultvalue'><formula>"*"</formula></code><code event='inputtranslation'><formula
>@If(OrgUnit3= "" : " "; "*"; @Trim(OrgUnit3))</formula></code><code event='inputvalidation'><formula
>L_ERR_MSG := "The maximum length of an organizational unit is 32 bytes.";

sMsg := @If(@Length(OrgUnit3)&gt;32; L_ERR_MSG; "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='7' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='89'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='105'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='91'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px' htmlid='DomainTable1_i'>
<par def='99'><run><font size='9pt'/></run><popup show='onclick' hotspotstyle='none'><popuptext
>Organization unit 4. * means any organization unit.</popuptext><run><font
 size='9pt'/>Org Unit 4:</run></popup><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<par def='100'><run><font size='9pt'/></run><run><font size='9pt'/><field
 type='text' kind='editable' name='OrgUnit4' description='Specify the X.400 Organizational unit to use in routing rules. * means any organizational unit.'><code
 event='defaultvalue'><formula>"*"</formula></code><code event='inputtranslation'><formula
>@If(OrgUnit4= "" : " "; "*"; @Trim(OrgUnit4))</formula></code><code event='inputvalidation'><formula
>L_ERR_MSG := "The maximum length of an organizational unit is 32 bytes.";

sMsg := @If(@Length(OrgUnit4)&gt;32; L_ERR_MSG; "");

REM {return error message};
_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");
_tMsg  := @ReplaceSubstring(sMsg; "\\":"'":"\""; "%5C":"%27":"%22");
_tWeb1 := "&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;";
_tWeb2 := "&lt;script&gt;ntValidationFailure('" + _tMsg + "');&lt;/script&gt;";
_tWeb  := _tWeb1 + _tWeb2;

@If(sMsg = "";
	@Success;
	@Failure(@If(@ClientType = "Notes"; sMsg; _tWeb)))</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='7' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='89'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='105'><run><font size='9pt'/></run></par></tablecell>
<tablecell borderwidth='0px'>
<par def='91'><run><font size='9pt'/></run></par></tablecell></tablerow></table>
<pardef id='106' leftmargin='1%' keepwithnext='true' keeptogether='true'><code
 event='hidewhen'><formula>@IsNotMember(DomainType;"DomainRule":"SMTPDomain")</formula></code></pardef>
<par def='106'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow tablabel='Comments'>
<tablecell borderwidth='0px' bgcolor='white'>
<pardef id='107' leftmargin='0.1000in' keepwithnext='true' keeptogether='true'/>
<par def='107'><run><font size='9pt'/></run></par>
<par def='107'><run><font size='9pt'/></run><run><font size='9pt'/><field
 showdelimiters='false' type='richtext' kind='editable' name='Comments' description='Comments about the connection description'><code
 event='htmlattributes'><formula>htmlTextarea10XXL</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='7' containertype='65418'
 aftercontainercount='1' afterbegincount='4'>
Yg4BAIQAAAAAAAEAAAA=
</compositedata><run><font size='9pt'/></run></par>
<par def='107'><run><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow tablabel='Administration'>
<tablecell borderwidth='0px' bgcolor='white'>
<par def='8'><run><font size='9pt'/></run></par>
<table cellbordercolor='silver' htmlclass='TableSpacing' leftmargin='0.1000in'
 rightmargin='50%' widthtype='fixedleft' rowspacing='0.0201in' refwidth='5.5000in'><tablecolumn
 width='1.5000in'/><tablecolumn width='4in'/>
<tablerow>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='108' leftmargin='0.0597in' keepwithnext='true' keeptogether='true'/>
<par def='108'><run><font size='9pt' style='bold' color='white'/>Administration</run></par></tablecell>
<tablecell borderwidth='0px' bgcolor='#b1b1d2'>
<pardef id='109' keepwithnext='true' keeptogether='true'/>
<par def='109'><run><font size='9pt' color='#f7f7f7'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='0px 0px 1px'>
<par def='12'><run><font size='9pt'/>Owners:</run></par></tablecell>
<tablecell borderwidth='0px 0px 1px'>
<par def='13'><run><font size='9pt'/></run><run><font size='9pt'/><sharedfieldref
 name='Owner'/></run><run html='true'><font size='9pt'/></run><run html='true'><font
 size='9pt'/><computedtext><code event='value'><formula>REM {Web address picker};

@If(@ClientType = "Notes" | !@IsDocBeingEdited; @Return(""); "");


_tLabelOneItem	:= "owner";


REM {DNT};
_tFieldName	:= "Owner";
_tDb   		:= @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");

"&lt;a onclick=\"

	var hDlg = window.hDlgAddrMulti;

	hDlg.sMsgOneEntry	= '"+ _tLabelOneItem +"';
	hDlg.hDestField	= document.forms[0]." + _tFieldName + ";
	hDlg.dlOpen();

	return false;

\" href=\"\"&gt;&lt;img src=\"/" + _tDb + "/btnPicker.gif?OpenImageResource\" width=\"15\" height=\"11\" border=\"0\" alt=\"\"&gt;&lt;/a&gt;"</formula></code></computedtext></run><run
><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<pardef id='110' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'/>
<par def='110'><run><font size='9pt'/>Administrators:</run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='111' leftmargin='0.0597in' rightmargin='100%' keepwithnext='true'
 keeptogether='true'/>
<par def='111'><run><font size='9pt'/></run><run><font size='9pt'/><sharedfieldref
 name='LocalAdmin'/></run><run html='true'><font size='9pt'/></run><run html='true'><font
 size='9pt'/><computedtext><code event='value'><formula>REM {Web address picker};

@If(@ClientType = "Notes" | !@IsDocBeingEdited; @Return(""); "");


_tLabelOneItem	:= "administrator";


REM {DNT};
_tFieldName	:= "LocalAdmin";
_tDb   		:= @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");

"&lt;a onclick=\"

	var hDlg = window.hDlgAddrMulti;

	hDlg.sMsgOneEntry	= '"+ _tLabelOneItem +"';
	hDlg.hDestField	= document.forms[0]." + _tFieldName + ";
	hDlg.dlOpen();

	return false;

\" href=\"\"&gt;&lt;img src=\"/" + _tDb + "/btnPicker.gif?OpenImageResource\" width=\"15\" height=\"11\" border=\"0\" alt=\"\"&gt;&lt;/a&gt;"</formula></code></computedtext></run><run
><font size='9pt'/></run></par></tablecell></tablerow>
<tablerow>
<tablecell borderwidth='1px 0px'>
<pardef id='112' leftmargin='0.0597in' hide='edit previewedit' keepwithnext='true'
 keeptogether='true'/>
<par def='112'><run><font size='9pt'/>Last updated:</run></par></tablecell>
<tablecell borderwidth='1px 0px'>
<pardef id='113' leftmargin='0.0597in' hide='edit previewedit' keepwithnext='true'
 keeptogether='true'/>
<par def='113'><run><font size='9pt'/></run><run><font size='9pt'/><sharedfieldref
 name='LastMod'/></run><run><font size='9pt'/></run></par></tablecell></tablerow></table>
<par def='28'><run><font size='9pt'/></run></par></tablecell></tablerow></table>
<pardef id='114' leftmargin='1in'/>
<par def='114'/>
<pardef id='115' leftmargin='1in' hide='read edit print copy preview previewedit'/>
<par def='115'><run><font size='9pt' style='bold'/></run><run><font size='9pt'/><field
 type='text' kind='computed' name='X400NotesDomainAttribute'><code event='defaultvalue'><formula
>@If(X400ChooseDomainAttribute="DDA1";X400DomainDefinedAttribute;X400ChooseDomainAttribute)</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='7' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run><run
><font size='9pt'/><field type='text' kind='computed' name='DomainName'><code
 event='defaultvalue'><formula>@If(DomainType="SMTPDomain";SMTPDomainName;OtherDomainName)</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='13' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run><run
><font size='9pt'/><field type='text' kind='computed' name='MailServer'><code
 event='defaultvalue'><formula>@If(	DomainType="DomainRule";DomainRuleMailServer;
	DomainType="ForeignDomain":"ccMailDomain";ForeignDomainMailServer;
	DomainType="SMTPDomain";DomainRuleMailServer;
	@Unavailable)</formula></code></field></run><compositedata type='98' prevtype='65418'
 nexttype='222' afterparcount='19' containertype='65418' aftercontainercount='1'
 afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run><run><font
 size='9pt'/><field type='text' kind='computed' name='NextDomain'><code event='defaultvalue'><formula
>@If(DomainType = "NonAdjacentDomain"; NonAdjacentNextDomain;
    DomainType = "DomainRule":"SMTPDomain"; DomainRuleNextDomain; @Unavailable)</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='25' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run><run
><font size='9pt'/><field type='text' allowmultivalues='true' protected='true'
 name='Type' listinputseparators='semicolon' listdisplayseparator='semicolon'><code
 event='defaultvalue'><formula>"Domain"</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='31' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run><run
><font size='9pt'/><sharedfieldref name='DocumentAccess'/></run><run><font
 size='9pt' color='green'/></run><run><font size='9pt'/><field type='text'
 allowmultivalues='true' kind='computed' name='SMTPDomainSuffixes' description='Specify the Internet domain suffix.'
 listinputseparators='comma semicolon newline' listdisplayseparator='newline'><code
 event='defaultvalue'><formula>LocalPrimaryInternetDomain:LocalInternetDomainAliases</formula></code></field></run><compositedata
 type='98' prevtype='65418' nexttype='222' afterparcount='45' containertype='65418'
 aftercontainercount='1' afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run><run
><font size='9pt'/><field type='text' kind='computedfordisplay' name='$$Return'><code
 event='defaultvalue'><formula>_tDb   := @ReplaceSubstring(@Subset(@DbName; -1); " ":"\\" ; "+":"/");

"&lt;link rel=stylesheet type='text/css' href='/" + _tDb + "/cssForm?ReadForm'&gt;
&lt;script src='/" + _tDb + "/WebJSNavigationTools?OpenJavaScriptLibrary'&gt;&lt;/script&gt;
&lt;script&gt;
	sWebDbName = '/" + _tDb + "/';
	ntReturn();
&lt;/script&gt;"</formula></code></field></run><compositedata type='98' prevtype='65418'
 nexttype='222' afterparcount='51' containertype='65418' aftercontainercount='1'
 afterbegincount='3'>
Yg4BAIQAAAAAAAAAAAA=
</compositedata><run><font size='9pt'/></run></par>
<par def='115'><run><font size='9pt' color='blue'/></run><run><font size='9pt'
 color='blue'/><field type='number' kind='editable' name='$SrvrDom'><numberformat
 format='general' digits='2' punctuated='false' parens='false' percent='false'
 bytes='false'/><code event='defaultvalue'><formula>0</formula></code></field></run><run
><font size='9pt' color='blue'/></run></par>
<pardef id='116' leftmargin='2.7500in' firstlineleftmargin='1in'/>
<par def='116'><run><font size='9pt' color='green'/></run></par></richtext></body>
<item name='$SubForm_RepIDs' sign='true'><text>0000000000000000</text></item>
<item name='OriginalModTime' sign='true'><datetime>20050210T202426,60-05</datetime></item>
<item name='$FormUsers' sign='true'><text>[NetCreator]</text></item>
<item name='$SrvrDom' summary='false' sign='true'><number>0</number></item>
<item name='$DomainType_O' sign='true'>
<rawitemdata type='14'>
AQAAAkxTT0IDABQIZW4AAAQAGgB3AAQAAACkBggDAAAAAAAAfAPcBQAAAAAsAKQAIABAAAABAABc
AAAAAAAAAAIAAAAEAFgBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAABABYAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAYAAAC4ANwF3AKIA7gAuAAMAgwCAAAAAEwETAQAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAADcBdwFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAEABQBMb3R1cyBQcm9kdWN0AAAAVjAuMAAAAAAAAAAAAAAAAAAA
AAAEAAAAdwAAAAAAAACkBgAACAMAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAA
AAUAAABXMzJJJQMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAwAMAwAAAADAAAwAJAAkAEQATwBNAEEASQBOAFQAWQBQAEUAAAAAAHQAAwBOAEUAVwAAAIgA
BgBEAEUATABFAFQARQAAAAAAcAEKAEkATgBJAFQASQBBAEwASQBaAEUAAAAAAGABCQBUAEUAUgBN
AEkATgBBAFQARQAAAEwBBgBPAEIASgBFAEMAVAAAAAAAkAAAAAAAAADcAAYAUwBPAFUAUgBDAEUA
AAAAAOwACgBCAEkATgBEAEUAVgBFAE4AVABTAAAAAAAkAQsATwBCAEoARQBDAFQATgBBAE0ARQBf
AAAA//8FAEYASQBFAEwARAAAABgBBgAlAEwAUwBJAEQARQAAAAAA//8IAE8ATgBDAEgAQQBOAEcA
RQAAAAAAbAICAFcAUwAAAAAA9AEQAE4ATwBUAEUAUwBVAEkAVwBPAFIASwBTAFAAQQBDAEUAAAAA
ADACBgAlAEwAUwBYAFUASQAAAAAAlAEFAFUASQBEAE8AQwAAAMABDwBOAE8AVABFAFMAVQBJAEQA
TwBDAFUATQBFAE4AVAAAAKABAwBEAE8AQwAAANQBDQBOAE8AVABFAFMARABPAEMAVQBNAEUATgBU
AAAA//8GACUATABTAFgAQgBFAAAAAABQAg0ATgBPAFQARQBTAEQAQQBUAEEAQgBBAFMARQAAABgC
DwBDAFUAUgBSAEUATgBUAEQATwBDAFUATQBFAE4AVAAAAIwCCABEAE8AQwBVAE0ARQBOAFQAAAAA
AP//DABHAEUAVABJAFQARQBNAFYAQQBMAFUARQAAAAAAtAIKAEQAbwBtAGEAaQBuAFQAeQBwAGUA
AAAAAP//DABHAGwAbwBiAGEAbABEAG8AbQBhAGkAbgAAAAAA8AIQAFIARQBQAEwAQQBDAEUASQBU
AEUATQBWAEEATABVAEUAAAAAAOgCFwBTAE0AVABQAE4AbwB0AGUAcwBEAG8AbQBhAGkAbgBJAG4A
YwBsAHUAZABlAGQAAAD//wEAMAAAAP//CQBOAE8AVABFAFMASQBUAEUATQAAAAUAqAYAAAAAUEUR
9QgAAABYAVgBqAAAAAAAAAACAAAAnABIAQAAAAAAAAAAAAAAAAAAAACcAJwAAAAAAAAAAAAAAAAA
AAAAAAAAAABIAUgBAAAAAAAAAAABAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwABAEgBAADEAAYIAAAAABoA
AADwAP//AAAAABAAAAAMAgAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADFhMp7S5pEL9dAN0BEYa3AAAAAAAAAAAAAAAA
AAAAAGQAAAAAAAAAAAAAAAAAAAACAKwAAAAgBQAAAABcBAEA//8AAAMAIAAAAAAAlAAJAgAAuAAI
AAAAAAAAAAQBAAAAAAAABAAAAPABEAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADMAhAFbANsAwAA
AAAAAAAA8AHwAQAAAAAAAAAAAQAAAAsAAAAhAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAQDMAgAAlAAJAgAAuAAaAKwA
UAH//wAAAAAQAAAA3AIAACgBAAAAAAAAAQAAADAFMAUAAAAAMAUwBQAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhUTKe0uaRC/XQDdARGGtwAAAAAAAAAAAAAAAAAA
AABkAAAAAAAAAAAAAAAAAAAAAgAAApwCAAC4AAAACgABAP//AAASABQAAAAAAP//CQIAAAAAAAYA
AAAADAIAAv//AAAAAAQAAQAAAAkCDAIJAgwCGQADAAIAbAMQBRwBCQIAAAwCEAAAAIgDiAN0AQAA
AAAAAAEAAABUBVQFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABU
BVQFAAAAAAQVEyntLmkQv10A3QERhrcAAAAAAAAAAAAAAAAAAAAAZAAAAAAAAAAAAAAAAAAAAAIA
AAIAAAAADAIAAAoAAQD//wAAAwACABAFAABkAQkCBADcAhoAAALEAf//AAAAABAABABMBAAApAEA
AAAAAAACAAAAeAWoBQAAAAAAAAAAqAWoBQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
eAV4BQAAAAAEFBMp7S5pEL9dAN0BEYa3LhQTKe0uaRC/XQDdARGGt2QAAAAAAAAAAAAAAAAAAAAC
AHwDGAQAAEwEAAACAAEA//8AABIAFAAAAAAA//8JAgAAAACNBAAAAACIA3wD//8AAAAABgACAAAA
CQKIAwkCiAMJAkwEGQAQAAAA3AUAANgBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAhQTKe0uaRC/XQDdARGGtwAAAAAAAAAA
AAAAAAAAAABkAAAAAAAAAAAAAAAAAAAAAgB8A9wEAADcAgAAAgABAP//AAASABQAAAAAAP//CQIA
AAAAEgQAAAAATAR8A///AAAAAAYAAwAAAAkCTAQJAkwEBggGCBkAAwACAAAAAACYAQkCCACIAxMA
AAAEAQAA7AAAAAAAAAARABAFAAAAAPgBCQLiBQAAAAAAAAAAAAAAAAAAAAAAAAAA3AIRABAFAAAA
ABwCCQKoBgAAAAAAAAAAAAAAAAAAAAAAAAAAiAMSABQAqAUAADQCAAAAAAAAlQQAAAAAiAN8A///
AAAAAAQAAgAAAAAACQKIAwYIGQASABQAAAAAAJACCYIAAAAAlwQAAAAAiAN8A///AAAAAAYAAwAA
AAkC3AUJAogDBggAABkAEAAAAAAAAAD0AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUUEyntLmkQv10A3QERhrcuFBMp7S5p
EL9dAN0BEYa3ZAAAAAAAAAAAAAAAAAAAAAIAfANsBgAAiAMAAAIAAQD//wAAEgAUAAAAAAD//wkC
AAAAACgEAAAAANwFfAP//wAAAAAJAAUAAAAJAtwFCQLcBQkKiAMGCAAAgQgEAHsAAAAAAB0AABoL
AFtIAUmcAMq4AKYaDABHSAHL7AAAAFgBGg0AHRoRAF7MAisMAiSmGhUAXmwDS8wCLTAFI6YaFgBe
EAVLbAMtVAUjphoYAEsQBSx4BX1UAiOFZAF9cAK4OBEAGhkASxAFLKgFfbgCfewCIzEaGgAaGwAd
AgAAABEAGAAAAAAA//8BAAMAAwAAAAYAqAAIAAQBDwAKAAAAAA==
</rawitemdata></item>
<item name='$$ScriptName' summary='false' sign='true'><text>Domain</text></item></form>

